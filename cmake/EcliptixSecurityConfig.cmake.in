@PACKAGE_INIT@

# Ecliptix Security Library Configuration File
#
# This file allows other projects to find and use the Ecliptix Security Library
# through CMake's find_package() mechanism.
#
# Usage example:
#   find_package(EcliptixSecurity REQUIRED)
#   target_link_libraries(your_target Ecliptix::ecliptix_security)

include(CMakeFindDependencyMacro)

# Find required dependencies
find_dependency(OpenSSL REQUIRED)
find_dependency(Threads REQUIRED)

# Find libsodium (try pkg-config first, then direct search)
find_dependency(PkgConfig)
if(PkgConfig_FOUND)
    pkg_check_modules(SODIUM libsodium)
endif()

if(NOT SODIUM_FOUND)
    find_library(SODIUM_LIBRARY sodium)
    find_path(SODIUM_INCLUDE_DIR sodium.h)
    if(SODIUM_LIBRARY AND SODIUM_INCLUDE_DIR)
        set(SODIUM_FOUND TRUE)
    else()
        message(FATAL_ERROR "Required dependency libsodium not found")
    endif()
endif()

# Include the exported targets
include("${CMAKE_CURRENT_LIST_DIR}/EcliptixSecurityTargets.cmake")

# Provide information about the library
set(EcliptixSecurity_VERSION "@PROJECT_VERSION@")
set(EcliptixSecurity_VERSION_MAJOR "@PROJECT_VERSION_MAJOR@")
set(EcliptixSecurity_VERSION_MINOR "@PROJECT_VERSION_MINOR@")
set(EcliptixSecurity_VERSION_PATCH "@PROJECT_VERSION_PATCH@")

# Check if all required components are available
check_required_components(EcliptixSecurity)

# Set variables for backwards compatibility
if(TARGET Ecliptix::ecliptix_security)
    set(EcliptixSecurity_FOUND TRUE)
    set(ECLIPTIX_SECURITY_FOUND TRUE)

    # Get target properties for legacy variables
    get_target_property(EcliptixSecurity_INCLUDE_DIRS Ecliptix::ecliptix_security INTERFACE_INCLUDE_DIRECTORIES)
    set(EcliptixSecurity_LIBRARIES Ecliptix::ecliptix_security)
    set(ECLIPTIX_SECURITY_LIBRARIES ${EcliptixSecurity_LIBRARIES})
    set(ECLIPTIX_SECURITY_INCLUDE_DIRS ${EcliptixSecurity_INCLUDE_DIRS})
else()
    set(EcliptixSecurity_FOUND FALSE)
    set(ECLIPTIX_SECURITY_FOUND FALSE)
endif()

# Provide usage hints
if(EcliptixSecurity_FOUND AND NOT EcliptixSecurity_FIND_QUIETLY)
    message(STATUS "Found Ecliptix Security Library v${EcliptixSecurity_VERSION}")
    message(STATUS "  Include dirs: ${EcliptixSecurity_INCLUDE_DIRS}")
    message(STATUS "  Libraries: ${EcliptixSecurity_LIBRARIES}")
    message(STATUS "")
    message(STATUS "Usage example:")
    message(STATUS "  target_link_libraries(your_target Ecliptix::ecliptix_security)")
    message(STATUS "  #include \"ecliptix/api.hpp\"")
endif()